# ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ò–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò 1PLAT

## üéØ –ó–∞–¥–∞—á–∞

–ó–∞–º–µ–Ω–∏—Ç—å **Yookassa** –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é **1Plat** –¥–ª—è –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–∞–º–∏ –∏ –°–ë–ü –≤ Telegram –±–æ—Ç–µ.

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ó–ê–í–ï–†–®–ï–ù–û

–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã 1Plat —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ production —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é.

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã: 5

```
1. services/oneplat.py             (196 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ create_oneplat_payment()      - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ API
   ‚îú‚îÄ get_payment_info()            - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ
   ‚îú‚îÄ verify_callback()             - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π callback'–æ–≤
   ‚îú‚îÄ verify_callback_signature()   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–¥–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏
   ‚îî‚îÄ get_payment_status_description() - –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

2. handlers/webhooks.py            (119 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ handle_oneplat_webhook()     - GET /1plat-webhook endpoint
   ‚îú‚îÄ set_bot()                    - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞ –≤ webhook
   ‚îî‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π

3. 1PLAT_INTEGRATION.md            (284 —Å—Ç—Ä–æ–∫–∏)
   ‚îú‚îÄ –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   ‚îú‚îÄ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
   ‚îú‚îÄ –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã (–¥–∏–∞–≥—Ä–∞–º–º–∞)
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π
   ‚îî‚îÄ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

4. ONEPLAT_DEPLOYMENT.md           (445 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
   ‚îú‚îÄ SSH, git, Python setup
   ‚îú‚îÄ Nginx –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è webhook'–æ–≤
   ‚îú‚îÄ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Let's Encrypt
   ‚îú‚îÄ Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
   ‚îî‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

5. test_1plat_webhook.py           (168 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–æ–≤
   ‚îú‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
   ‚îî‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö callback'–æ–≤

–ò–¢–û–ì–û: 1212 —Å—Ç—Ä–æ–∫ –Ω–æ–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∫–æ–¥–∞
```

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: 8

```
1. handlers/subscription.py        (‚úèÔ∏è +100 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ process_pay_yookassa()       - –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
   ‚îú‚îÄ process_pay_1plat()          - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –∏ –ø–æ–∫–∞–∑ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
   ‚îú‚îÄ process_check_oneplat_payment() - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ –≤—Ä—É—á–Ω—É—é
   ‚îî‚îÄ –ò–º–ø–æ—Ä—Ç create_oneplat_payment –∏–∑ services

2. config.py                       (‚úèÔ∏è +4 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   ‚îú‚îÄ ONEPLAT_SHOP_ID
   ‚îú‚îÄ ONEPLAT_SHOP_SECRET
   ‚îú‚îÄ ONEPLAT_BASE_URL
   ‚îî‚îÄ ONEPLAT_CALLBACK_URL

3. database.py                     (‚úèÔ∏è +20 —Å—Ç—Ä–æ–∫)
   ‚îú‚îÄ –ú–∏–≥—Ä–∞—Ü–∏—è: payment_guid –∏ payment_method
   ‚îú‚îÄ create_oneplat_payment()
   ‚îú‚îÄ get_payment_by_guid()
   ‚îú‚îÄ get_pending_oneplat_payments()
   ‚îú‚îÄ update_payment_status_by_guid()
   ‚îî‚îÄ update_payment_status_by_invoice() - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

4. states.py                       (‚úèÔ∏è +1 —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
   ‚îî‚îÄ choosing_1plat_method        - –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã (–∫–∞—Ä—Ç–∞/–°–ë–ü)

5. main.py                         (‚úèÔ∏è Quart –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
   ‚îú‚îÄ –ò–º–ø–æ—Ä—Ç Quart –∏ webhook blueprint
   ‚îú‚îÄ app = Quart(__name__)        - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   ‚îú‚îÄ run_webhook_server()         - –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ 8080
   ‚îú‚îÄ asyncio.gather()             - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ polling –∏ webhook
   ‚îî‚îÄ set_bot(bot)                 - –ü–µ—Ä–µ–¥–∞—á–∞ –±–æ—Ç–∞ –≤ webhook

6. services/cryptobot.py           (‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∞)
   ‚îî‚îÄ process_paid_invoice()       - –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±–æ–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

7. requirements.txt                (‚úèÔ∏è +1 –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
   ‚îî‚îÄ quart>=0.18.0                - Async –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è webhook'–æ–≤

8. .env.example                    (‚úèÔ∏è +4 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   ‚îú‚îÄ ONEPLAT_SHOP_ID
   ‚îú‚îÄ ONEPLAT_SHOP_SECRET
   ‚îú‚îÄ ONEPLAT_BASE_URL
   ‚îî‚îÄ ONEPLAT_CALLBACK_URL

–ò–¢–û–ì–û: 8 —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ, ~140 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

```
‚úÖ 1plat.txt                       - –§–∞–π–ª –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞
‚úÖ check_syntax.py                 - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Python
‚úÖ INTEGRATION_SUMMARY.md          - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ (380 —Å—Ç—Ä–æ–∫)
‚úÖ NEXT_STEPS.md                   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (481 —Å—Ç—Ä–æ–∫–∞)
‚úÖ COMPLETION_SUMMARY.md           - –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚úÖ CHANGES.md                      - –û–±–Ω–æ–≤–ª—ë–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ 1Plat
```

---

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

#### ‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ –∫–∞—Ä—Ç–∞–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ VISA, MasterCard, –ú–ò–†
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã:
  - –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã
  - –§–ò–û –ø–æ–ª—É—á–∞—Ç–µ–ª—è
  - –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞

#### ‚úÖ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –°–ë–ü
- –ü–ª–∞—Ç–µ–∂–∏ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ë—ã—Å—Ç—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π (BSP)
- –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö —Ä—É—Å—Å–∫–∏—Ö –±–∞–Ω–∫–∞—Ö

#### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
- –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è callback'–∞ –æ—Ç 1Plat
- –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ = 1 –∏–ª–∏ 2 (–æ–ø–ª–∞—á–µ–Ω–æ)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)

#### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HMAC-SHA256 (signature)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MD5 (signature_v2)
- –í–∞–ª–∏–¥–Ω–∞ –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –¥–≤—É—Ö –ø–æ–¥–ø–∏—Å–µ–π –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ callback'–æ–≤

#### ‚úÖ Webhook —Å–µ—Ä–≤–µ—Ä
- Quart –Ω–∞ –ø–æ—Ä—Ç–µ 8080
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å polling –±–æ—Ç–æ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

#### ‚úÖ –°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π
- -2: –û—à–∏–±–∫–∞ (–∑–∞–ø–∏—Å—å –∫–∞–∫ failed)
- -1: –ß–µ—Ä–Ω–æ–≤–∏–∫ (–æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –º–µ—Ç–æ–¥–∞)
- 0: –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã (–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º)
- 1: –û–ø–ª–∞—á–µ–Ω ‚úÖ (–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å–∫—É)
- 2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω ‚úÖ (–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å–∫—É)

#### ‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
- –†–∞–±–æ—Ç–∞–µ—Ç —Å 1Plat –ø–ª–∞—Ç–µ–∂–∞–º–∏
- +7 –¥–Ω–µ–π –∑–∞ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ function process_paid_invoice()

#### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤—Ä—É—á–Ω—É—é
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É"
- –ó–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –∏–∑ API 1Plat
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (Telegram)
         ‚îÇ
         ‚Üì
   –ë–æ—Ç (handlers/subscription.py)
    ‚îú‚îÄ process_pay_yookassa()    - –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞
    ‚îú‚îÄ process_pay_1plat()       - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
    ‚îî‚îÄ process_check_oneplat_payment() - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
         ‚îÇ
         ‚îú‚îÄ API –∑–∞–ø—Ä–æ—Å ‚Üí services/oneplat.py
         ‚îÇ              ‚îú‚îÄ create_oneplat_payment()
         ‚îÇ              ‚îî‚îÄ get_payment_info()
         ‚îÇ
         ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí database.py
         ‚îÇ              ‚îî‚îÄ create_oneplat_payment()
         ‚îÇ
         ‚îî‚îÄ –ü–æ–∫–∞–∑ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

1Plat –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
         ‚îÇ
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç
         ‚îÇ
         ‚Üì
  1Plat –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç callback
         ‚îÇ
         ‚Üì
Webhook —Å–µ—Ä–≤–µ—Ä (handlers/webhooks.py)
         ‚îÇ
    ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ POST –∑–∞–ø—Ä–æ—Å–∞
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
    ‚îî‚îÄ –ï—Å–ª–∏ –æ–ø–ª–∞—á–µ–Ω–æ:
       ‚îú‚îÄ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (race condition)
       ‚îú‚îÄ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ (services/cryptobot.py)
       ‚îú‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
       ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
       ‚îî‚îÄ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegram Bot (Aiogram)             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Polling: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥       ‚îÇ ‚îÇ
‚îÇ  ‚îÇ handlers/subscription.py        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ handlers/start.py               ‚îÇ ‚îÇ
‚îÇ  ‚îÇ ... –∏ –¥—Ä—É–≥–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Quart Webhook Server (Port 8080)‚îÇ ‚îÇ
‚îÇ  ‚îÇ handlers/webhooks.py            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ GET /1plat-webhook              ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ –°–µ—Ä–≤–∏—Å—ã:                        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - services/oneplat.py           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - services/cryptobot.py         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ - services/remnawave.py         ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: PostgreSQL (Supabase) ‚îÇ
‚îÇ  ‚îÇ database.py (async/await)       ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì‚Üë HTTPS (Nginx reverse proxy)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   1Plat Payment API                  ‚îÇ
‚îÇ   https://1plat.cash/api             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–æ–∫ callback'–æ–≤

**–ú–µ—Ç–æ–¥ 1: HMAC-SHA256 (signature)**
```python
signature = HMAC-SHA256(JSON.stringify(payload), shopSecret)
```

**–ú–µ—Ç–æ–¥ 2: MD5 (signature_v2)**
```python
signature_v2 = MD5(merchantId + amount + shopId + shopSecret)
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
def verify_callback(body):
    v1_valid = verify_callback_signature(body, body.get("signature"), use_v2=False)
    v2_valid = verify_callback_signature(body, body.get("signature_v2"), use_v2=True)
    return v1_valid or v2_valid
```

### –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions

```python
if not await db.acquire_user_lock(tg_id):
    return  # –ü–æ–¥–æ–∂–¥–∏

try:
    success = await process_paid_invoice(bot, tg_id, ...)
finally:
    await db.release_user_lock(tg_id)
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL advisory locks.

### –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞ –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ –ë–î –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ

1. **[INTEGRATION_SUMMARY.md](INTEGRATION_SUMMARY.md)** (380 —Å—Ç—Ä–æ–∫)
   - ‚≠ê –ù–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞!
   - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

2. **[1PLAT_INTEGRATION.md](1PLAT_INTEGRATION.md)** (284 —Å—Ç—Ä–æ–∫–∏)
   - –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - –û–ø–∏—Å–∞–Ω–∏–µ API 1Plat
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

3. **[ONEPLAT_DEPLOYMENT.md](ONEPLAT_DEPLOYMENT.md)** (445 —Å—Ç—Ä–æ–∫)
   - –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ (77.233.214.150)
   - SSH, git clone, Python setup
   - Nginx –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è webhook'–æ–≤
   - SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Let's Encrypt
   - Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

4. **[NEXT_STEPS.md](NEXT_STEPS.md)** (481 —Å—Ç—Ä–æ–∫–∞)
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
   - –≠—Ç–∞–ø –∑–∞ —ç—Ç–∞–ø–æ–º
   - –ß–µ–∫-–ª–∏—Å—Ç—ã
   - –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **[CHANGES.md](CHANGES.md)** - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **[README.md](README.md)** - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **[test_1plat_webhook.py](test_1plat_webhook.py)** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **[check_syntax.py](check_syntax.py)** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ: ‚úÖ –ì–û–¢–û–í–û

- [x] –ü–æ–ª–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π 1Plat
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [x] –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [x] Webhook —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

### –î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º: ‚è≥ –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨

1. **–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç 1Plat:**
   - –ü–æ–ª—É—á–∏—Ç—å Shop ID –∏ Shop Secret –∏–∑ –õ–ö 1Plat
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å callback URL –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ 1Plat
   - –í—ã–±—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞

2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä (77.233.214.150):**
   - SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
   - git clone —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   - –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):**
   - –î–æ–±–∞–≤–∏—Ç—å ONEPLAT_SHOP_ID
   - –î–æ–±–∞–≤–∏—Ç—å ONEPLAT_SHOP_SECRET
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   - Nginx –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è webhook'–æ–≤
   - SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Let's Encrypt
   - Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏

5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å test_1plat_webhook.py
   - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
   - –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)
- [x] –ö–æ–¥ –≥–æ—Ç–æ–≤
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- [ ] 1Plat Shop ID –ø–æ–ª—É—á–µ–Ω
- [ ] 1Plat Shop Secret –ø–æ–ª—É—á–µ–Ω

### –≠—Ç–∞–ø 2: –°–µ—Ä–≤–µ—Ä
- [ ] SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] git clone –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Python 3.10 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] venv —Å–æ–∑–¥–∞–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- [ ] pip install -r requirements.txt –≤—ã–ø–æ–ª–Ω–µ–Ω

### –≠—Ç–∞–ø 3: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [ ] .env —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] DATABASE_URL –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] ONEPLAT_SHOP_ID —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] ONEPLAT_SHOP_SECRET —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –ø—Ä–æ–π–¥–µ–Ω

### –≠—Ç–∞–ø 4: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [ ] Nginx –∫–æ–Ω—Ñ–∏–≥ –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] /1plat-webhook –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ :8080
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] Systemd —Å–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–Ω

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] Webhook —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –Ω–∞ 8080
- [ ] test_1plat_webhook.py —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 6: 1Plat
- [ ] Callback URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –õ–ö
- [ ] –î–æ–º–µ–Ω –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- [ ] –ú–∞–≥–∞–∑–∏–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

### –≠—Ç–∞–ø 7: Production
- [ ] Systemd —Å–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–µ–Ω (enable)
- [ ] Systemd —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω (start)
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /start
- [ ] –ü–ª–∞—Ç–µ–∂–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üéì –ö–∞–∫ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

1. –ù–∞–ø–∏—à–µ—Ç –±–æ—Ç—É `/start`
2. –ü—Ä–∏–º–µ—Ç —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. –ù–∞–∂–º–µ—Ç "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
4. –í—ã–±–µ—Ä–µ—Ç —Ç–∞—Ä–∏—Ñ (1m, 3m, 6m, 12m)
5. –í—ã–±–µ—Ä–µ—Ç —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:
   - üíé CryptoBot (USDT, TON, BTC)
   - üí≥ Yookassa **‚Üí 1Plat**
6. –ï—Å–ª–∏ –≤—ã–±—Ä–∞–ª 1Plat:
   - –í—ã–±–µ—Ä–µ—Ç —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:
     - üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
     - üì± –°–ë–ü (—Ç–µ–ª–µ—Ñ–æ–Ω)
7. –ë—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω—ã —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã
8. –û–ø–ª–∞—Ç–∏—Ç –ø–ª–∞—Ç–µ–∂
9. 1Plat –æ—Ç–ø—Ä–∞–≤–∏—Ç callback –±–æ—Ç—É
10. –ë–æ—Ç –ø–æ–ª—É—á–∏—Ç callback –Ω–∞ webhook
11. –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
12. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å—Å—ã–ª–∫–æ–π

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

- –ú–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –≤ –ë–î
- –ú–æ–∂–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏: `sudo journalctl -u spn-bot -f`
- –ú–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å webhook'–∏: `python test_1plat_webhook.py 1`
- –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç–æ–º: `sudo systemctl restart spn-bot`

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- –í–µ—Å—å –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç async/await
- Webhook –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç polling –±–æ—Ç–∞
- –ú–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü—É–ª –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (5-20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö)
- Advisory locks –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –±–æ—Ç–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π callback'–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- SSL/TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

### –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –û—Ç–∫–∞—Ç –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

```
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:
- –ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤: 5
- –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: 8
- –°—Ç—Ä–æ–∫ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞: ~1200+
- –°—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: ~1200+

API endpoints:
- /1plat-webhook (POST)

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- aiogram >= 3.0.0
- quart >= 0.18.0
- asyncpg >= 0.28.0
- aiohttp >= 3.8.5

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç–µ–∂–∏:
- üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã (VISA, MasterCard, –ú–ò–†)
- üì± –°–ë–ü (–±—ã—Å—Ç—Ä—ã–µ –ø–ª–∞—Ç–µ–∂–∏)
- üíé CryptoBot (–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã - —Å—Ç–∞—Ä–æ–µ)

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–¥–ø–∏—Å–∏:
- HMAC-SHA256
- MD5
```

---

## üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã 1Plat:

‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –û–ø–ª–∞—Ç–∞ –ø–æ –∫–∞—Ä—Ç–∞–º –∏ –°–ë–ü —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π, –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–æ–∫  
‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –∏ edge cases  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ü–æ–ª–Ω–∞—è –∏ –ø–æ–¥—Ä–æ–±–Ω–∞—è  
‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–µ–Ω  
‚úÖ **Production Ready** - –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é  

---

## üìû –ß—Ç–æ –¥–∞–ª—å—à–µ

1. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [INTEGRATION_SUMMARY.md](INTEGRATION_SUMMARY.md)** - –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ (‚è±Ô∏è 5 –º–∏–Ω)

2. **–°–ª–µ–¥—É–π—Ç–µ [NEXT_STEPS.md](NEXT_STEPS.md)** - –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (‚è±Ô∏è 30 –º–∏–Ω)

3. **–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–π—Ç–µ –ø–æ [ONEPLAT_DEPLOYMENT.md](ONEPLAT_DEPLOYMENT.md)** (‚è±Ô∏è 1-2 —á–∞—Å–∞)

4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å [test_1plat_webhook.py](test_1plat_webhook.py)** (‚è±Ô∏è 5 –º–∏–Ω)

5. **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 77.233.214.150** (‚è±Ô∏è 15 –º–∏–Ω)

---

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ:** ‚ùå –ó–∞–≥–ª—É—à–∫–∞ Yookassa (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)  
**–ü–æ—Å–ª–µ:** ‚úÖ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã 1Plat (—Ä–∞–±–æ—Ç–∞–µ—Ç!)

–ë–æ—Ç —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑:
- üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
- üì± –°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π (–°–ë–ü)
- üíé –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã (CryptoBot - —Å—Ç–∞—Ä–æ–µ)

**–ì–æ—Ç–æ–≤–æ –∫ production! üöÄ**

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä

Hamzat Yaudarov

## –í–µ—Ä—Å–∏—è

1.0.0 - Complete 1Plat Payment Integration
